<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>Week 02 Home Work</title>
  <script>
  	const str = '广州，加油';
  	const num = '0x1024';
  	const char = '\''
  	console.log('str --> ' + str);
  	console.log('num --> ' + num);
  	console.log('num --> ' + char);
  	console.log('匹配所有 Number 直接量 isNumber('+ num + ') --> ' + isNumber(num));
  	console.log('匹配所有的字符串直接量，单引号和双引号 isChar(' + char + ') --> ' + isChar(str));
  	console.log('实现UTF-8编码 utf8Encoding(' + str + ') --> ' + utf8Encoding(str));
  	// console.log('使用TextEncoder编码 utf8Encoding(str) --> ' + encoderUTF8(str));

  	// 非作业范围仅用于验证 实现utf8encoding 是否正确
 //  	function encoderUTF8(str) {
	//     const encoder = new TextEncoder('utf8');
	//     return encoder.encode(str);
	// }

	// 作业: 实现utf-8编码
  	function utf8Encoding(str) {
  		let bytes = [];
	    for (let index = 0; index < str.length; index++) {
	        let code = str.charCodeAt(index);
	        if (0x00 <= code && code <= 0x7f) {
	           bytes.push(code)
	        } else if (0x80 <= code && code <= 0x7ff) {
	           bytes.push(0b11000000 | (0b00011111 & (code >> 6)));
	           bytes.push(0b10000000 | (0b00111111 & code));
	        } else if (0x800 <= code && code <= 0xffff) {
	           bytes.push(0b11100000 | (0b00001111 & (code >> 12)));
	           bytes.push(0b10000000 | (0b00111111 & (code >> 6)));
	           bytes.push(0b10000000 | (0b00111111 & code));
	        } else if (0x10000 <= code && code <= 0x10ffff) {
	           bytes.push(0b11110000 | (0b00000111 & (code >> 18)));
	           bytes.push(0b10000000 | (0b00111111 & (code >> 12)));
	           bytes.push(0b10000000 | (0b00111111 & (code >> 6)));
	           bytes.push(0b10000000 | (0b00111111 & code));
	        }
	    }
	    for (let index = 0; index < bytes.length; index++) {
	      bytes[index] &= 0xff;
	    }
	    const result = bytes.map((item) => '0x' + item.toString(16));
	    return result
	}

	// 作业: 匹配所有字符
	function isChar(str) {
		if (!str) {
			return false;
		}
		let reg = /[\u0021-\u007E]{6,16}|[\x21-\x7E]{6,16}|(['"])(?:(?!\1).)*?\1/;
		return reg.test(str);
	}

	// 作业: 匹配所有数字
	function isNumber(str) {
		if (!str) {
			return false;
		}
		let reg = /^[+-]?([0-9]*\.?[0-9]+|[0-9]+\.?[0-9]*)([eE][+-]?[0-9]+)?|([01]+)|([0-7])|(^0x[a-f0-9]{1,2}$)|(^0X[A-F0-9]{1,2}$)|(^[A-F0-9]{1,2}$)|(^[a-f0-9]{1,2}$)/;
		return reg.test(str);
	
	}
  </script>
</head>

<body>
  <div>
  	Week 02 Home Work
  </div>
</body>

</html>
